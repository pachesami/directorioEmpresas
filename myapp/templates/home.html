{% extends "base.html" %} 
{% block title %}Home ¬∑ Empresas{% endblock %} 
{% block content %}

<style>
  @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap");

  body {
    font-family: "Inter", sans-serif;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
  }

  @keyframes shimmer {
    0% { background-position: -1000px 0; }
    100% { background-position: 1000px 0; }
  }

  .float-anim {
    animation: float 6s ease-in-out infinite;
  }

  .shimmer-effect {
    background: linear-gradient(90deg, transparent, rgba(251, 191, 36, 0.3), transparent);
    background-size: 1000px 100%;
    animation: shimmer 3s infinite;
  }

  .card-hover {
    transition: all 0.3s ease;
  }

  .card-hover:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 60px rgba(251, 191, 36, 0.3);
  }
</style>

<!-- Efectos de fondo -->
<div class="fixed inset-0 pointer-events-none overflow-hidden">
  <div class="float-anim absolute top-1/4 left-1/4 w-96 h-96 bg-amber-500/20 rounded-full blur-[130px]"></div>
  <div class="float-anim absolute bottom-1/4 right-1/4 w-[500px] h-[500px] bg-yellow-600/15 rounded-full blur-[150px]" style="animation-delay: 2s"></div>
</div>

<div class="fixed inset-0 pointer-events-none opacity-[0.02]" style="background-image: linear-gradient(rgba(251, 191, 36, 0.5) 1px, transparent 1px), linear-gradient(90deg, rgba(251, 191, 36, 0.5) 1px, transparent 1px); background-size: 50px 50px;"></div>

<!-- Contenido principal -->
<div class="relative z-10 max-w-7xl mx-auto px-4 py-8">
{% load static %}

<div class="relative bg-gradient-to-br from-zinc-950/90 via-black to-zinc-950/90 backdrop-blur-xl border-2 border-amber-500/20 rounded-3xl p-6 md:p-8 mb-8 overflow-hidden shadow-2xl shadow-amber-500/10">
  <!-- l√≠nea superior -->
  <div class="absolute top-0 left-0 right-0 h-[2px] bg-gradient-to-r from-transparent via-amber-400/60 to-transparent"></div>

  <div class="relative flex flex-col md:flex-row items-center justify-between gap-6">
    <!-- Left: logo + t√≠tulo (logo a la izquierda, t√≠tulo a la derecha) -->
    <div class="flex items-center gap-6 w-full md:w-auto justify-center md:justify-start">
      <!-- Logo ampliado -->
      <div class="flex-shrink-0">
        <img
          src="{% static 'img/entrenandoLatinos.png' %}"
          alt="Logo Entrenando Latinos"
          class="h-20 md:h-28 object-contain transition-transform duration-300 transform hover:scale-[1.03] drop-shadow-[0_6px_18px_rgba(0,0,0,0.45)]"
          style="filter: brightness(0.98) saturate(0.9) contrast(0.98);"
          onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
        />
        <!-- Fallback si la imagen no carga -->
        <div id="logo-fallback" class="hidden items-center justify-center w-20 h-14 md:w-28 md:h-16 rounded-lg bg-gradient-to-r from-amber-400 to-yellow-300 shadow-lg" style="display:none;"></div>
      </div>

      <!-- T√≠tulo desplazado a la derecha del logo -->
      <div class="text-center md:text-left">
        <h1 class="text-3xl md:text-5xl font-extrabold leading-tight bg-gradient-to-r from-amber-300 via-yellow-400 to-amber-300 bg-clip-text text-transparent tracking-tight"
            style="margin-left: 0.25rem;">
          Directorio de Empresas
        </h1>
      </div>
    </div>

    <!-- Right: botones -->
    <div class="flex gap-3 flex-wrap justify-center md:justify-end">
      {% if is_admin and perms.myapp.add_empresa %}
      <button type="button"
        class="relative overflow-hidden bg-gradient-to-r from-amber-500 via-yellow-400 to-amber-500 hover:from-amber-400 hover:via-yellow-300 text-black font-bold py-3 px-6 rounded-xl transition-all transform hover:scale-105 active:scale-95 shadow-lg shadow-amber-500/40"
        data-bs-toggle="modal" data-bs-target="#empresaModal">
        <div class="shimmer-effect absolute inset-0 opacity-20"></div>
        <span class="relative flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/>
          </svg>
          Agregar Empresa
        </span>
      </button>
      {% endif %}

      <a href="{% url 'logout' %}"
        class="group relative overflow-hidden bg-zinc-900 hover:bg-zinc-800 border-2 border-amber-500/20 hover:border-amber-500/40 text-amber-400 hover:text-amber-300 font-bold py-3 px-6 rounded-xl transition-all transform hover:scale-105 active:scale-95 shadow-lg">
        <span class="relative flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"/>
          </svg>
          Cerrar sesi√≥n
        </span>
      </a>
    </div>
  </div>
  




  <!-- NUEVO: Enlace de texto para registrar usuario (Solo Admin) -->
  {% if is_admin %}
  <div class="mt-4 text-center">
    <a href="{% url 'signup' %}" class="inline-flex items-center gap-2 text-amber-400 hover:text-amber-300 transition-colors font-semibold text-sm group">
      <svg class="w-4 h-4 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/>
      </svg>
      <span class="border-b border-amber-400/30 group-hover:border-amber-300/50 transition-colors">Registrar un nuevo usuario</span>
    </a>
  </div>
  {% endif %}
</div>


  <!-- Buscador -->
  <div class="relative bg-zinc-950/80 backdrop-blur-xl border-2 border-amber-500/20 rounded-2xl p-6 mb-8 shadow-xl">
    <form class="flex flex-col gap-4" role="search" method="get" action="{% url 'home' %}">
      <div class="flex flex-col md:flex-row gap-3">
        <!-- Selector de campo -->
        <div class="relative">
          <select 
            name="field" 
            class="w-full md:w-48 bg-black/80 border-2 border-zinc-800 focus:border-amber-500/60 rounded-xl px-4 py-4 text-amber-50 focus:outline-none focus:ring-2 focus:ring-amber-500/30 transition-all font-medium appearance-none cursor-pointer"
            style="background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%23fbbf24%27 stroke-width=%272%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpolyline points=%276 9 12 15 18 9%27%3e%3c/polyline%3e%3c/svg%3e'); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1.25rem; padding-right: 2.5rem;"
          >
            <option value="all" {% if search_field == 'all' %}selected{% endif %}>Buscar en todo</option>
            <option value="compania" {% if search_field == 'compania' %}selected{% endif %}>Compa√±√≠a</option>
            <option value="cliente" {% if search_field == 'cliente' %}selected{% endif %}>Cliente</option>
            <option value="codigo" {% if search_field == 'codigo' %}selected{% endif %}>C√≥digo</option>
            {% if is_admin %}
            <option value="correo" {% if search_field == 'correo' %}selected{% endif %}>Correo</option>
            <option value="telefono" {% if search_field == 'telefono' %}selected{% endif %}>Tel√©fono</option>
            <option value="pais" {% if search_field == 'pais' %}selected{% endif %}>Pa√≠s</option>
            {% endif %}
          </select>
        </div>

        <div class="relative flex-1 group">
          <input class="relative w-full bg-black/80 border-2 border-zinc-800 group-focus-within:border-amber-500/60 rounded-xl px-5 py-4 text-amber-50 placeholder-zinc-600 focus:outline-none focus:ring-2 focus:ring-amber-500/30 transition-all font-medium" type="search" placeholder="Buscar empresa..." name="q" value="{{ q|default:'' }}"/>
        </div>
        <button class="group relative overflow-hidden bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-400 hover:to-amber-500 text-black font-bold py-4 px-8 rounded-xl transition-all transform hover:scale-105 active:scale-95 shadow-lg shadow-amber-500/30" type="submit">
          <span class="relative flex items-center justify-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/>
            </svg>
            Buscar
          </span>
        </button>
        {% if q %}
        <a class="flex items-center justify-center px-6 py-4 bg-zinc-900 hover:bg-zinc-800 border-2 border-amber-500/30 hover:border-amber-500/60 text-amber-400 hover:text-amber-300 font-bold rounded-xl transition-all" href="{% url 'home' %}">Limpiar</a>
        {% endif %}
      </div>
    </form>
    {% if q %}
    <div class="flex items-center gap-3 bg-amber-500/10 border border-amber-500/30 rounded-xl px-5 py-3 mt-4">
      <svg class="w-5 h-5 text-amber-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
      </svg>
      <p class="text-zinc-300 text-sm">
        Buscando <strong class="text-amber-400">"{{ q }}"</strong> en 
        <strong class="text-amber-400">
          {% if search_field == 'all' %}todos los campos
          {% elif search_field == 'compania' %}Compa√±√≠a
          {% elif search_field == 'cliente' %}Cliente
          {% elif search_field == 'codigo' %}C√≥digo
          {% elif search_field == 'correo' %}Correo
          {% elif search_field == 'telefono' %}Tel√©fono
          {% elif search_field == 'pais' %}Pa√≠s
          {% endif %}
        </strong>
        ¬∑ <span class="text-amber-400 font-bold">{{ empresas.paginator.count }}</span> resultados
      </p>
    </div>
    {% endif %}
  </div>



  
  <!-- Grid de cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mt-10">
    {% for e in empresas %}
    <div class="card-hover relative bg-gradient-to-b from-zinc-900/90 to-black/90 backdrop-blur-xl border-2 border-amber-500/30 rounded-3xl overflow-hidden shadow-xl group">
      <div class="absolute top-0 left-0 right-0 h-1.5 bg-gradient-to-r from-transparent via-amber-400 to-transparent"></div>
      
      {% if is_admin %}
      <div class="dropdown absolute top-5 right-5 z-10">
        <button class="w-12 h-12 flex items-center justify-center bg-black/80 hover:bg-black border-2 border-amber-500/30 hover:border-amber-500/60 text-amber-400 rounded-xl transition-all" data-bs-toggle="dropdown" aria-expanded="false">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
          </svg>
        </button>
        <ul class="dropdown-menu dropdown-menu-end shadow-xl" style="background: #18181b; border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 0.75rem; min-width: 160px;">
          {% if perms.myapp.change_empresa %}
          <li>
            <button class="dropdown-item text-amber-400 hover:bg-amber-500/10 py-3 px-4 rounded transition-all font-semibold" data-bs-toggle="modal" data-bs-target="#editarEmpresaModal{{ e.id }}">‚úèÔ∏è Editar</button>
          </li>
          {% endif %}
          {% if perms.myapp.delete_empresa %}
          <li>
            <button class="dropdown-item text-red-400 hover:bg-red-500/10 py-3 px-4 rounded transition-all font-semibold" data-bs-toggle="modal" data-bs-target="#eliminarEmpresaModal{{ e.id }}">üóëÔ∏è Eliminar</button>
          </li>
          {% endif %}
        </ul>
      </div>
      {% endif %}

      {% if e.logo %}
      <div class="relative h-64 bg-black/50 border-b-2 border-amber-500/20 overflow-hidden">
        <img src="{{ e.logo.url }}" class="w-full h-full object-contain p-6 group-hover:scale-110 transition-transform duration-500" alt="logo {{ e.compania }}"/>
      </div>
      {% else %}
      <div class="h-64 flex items-center justify-center bg-black/50 border-b-2 border-amber-500/20">
        <div class="text-center">
          <svg class="w-20 h-20 mx-auto text-amber-500/30 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
          </svg>
          <p class="text-zinc-600 font-semibold">Sin logo</p>
        </div>
      </div>
      {% endif %}

      <div class="p-8">
        <h5 class="text-3xl font-black text-amber-400 mb-3 leading-tight">{{ e.compania }}</h5>
        <div class="inline-block px-4 py-2 bg-amber-500/10 border border-amber-500/30 rounded-full text-sm font-bold text-amber-400 mb-6">C√≥digo: {{ e.codigo }}</div>
        
        <div class="space-y-3.5">
          <div class="flex items-start gap-3">
            <svg class="w-6 h-6 text-amber-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
            <div class="flex-1">
              <span class="text-amber-400 font-bold text-sm">Cliente:</span>
              <p class="text-zinc-200 text-base mt-1">{{ e.cliente }}</p>
            </div>
          </div>

          {% if is_admin %}
          <div class="flex items-start gap-3">
            <svg class="w-6 h-6 text-amber-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
            </svg>
            <div class="flex-1">
              <span class="text-amber-400 font-bold text-sm">Tel√©fono:</span>
              <p class="text-zinc-200 text-base mt-1">{{ e.telefono }}</p>
            </div>
          </div>

          <div class="flex items-start gap-3">
            <svg class="w-6 h-6 text-amber-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
            </svg>
            <div class="flex-1">
              <span class="text-amber-400 font-bold text-sm">Correo:</span>
              <p class="text-zinc-200 text-base mt-1 break-all">{{ e.correo }}</p>
            </div>
          </div>

          <div class="flex items-start gap-3">
            <svg class="w-6 h-6 text-amber-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <div class="flex-1">
              <span class="text-amber-400 font-bold text-sm">Pa√≠s:</span>
              <p class="text-zinc-200 text-base mt-1">{{ e.pais }}</p>
            </div>
          </div>
          {% endif %}
        </div>
      </div>

      <div class="px-8 py-5 bg-black/50 border-t border-amber-500/20">
        <div class="flex items-center gap-2 text-sm text-zinc-500">
          <svg class="w-5 h-5 text-amber-500/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <span class="font-medium">Registrada: {{ e.fecha_creacion|date:"d/m/Y H:i" }}</span>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-span-full text-center py-20">
      <svg class="w-32 h-32 mx-auto text-amber-500/20 mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
      </svg>
      <p class="text-zinc-500 text-xl font-semibold">A√∫n no hay empresas registradas.</p>
    </div>
    {% endfor %}
  </div>

  {% if empresas.has_other_pages %}
  <div class="flex justify-center items-center gap-2 mt-12">
    {% if empresas.has_previous %}
    <a href="?page=1{% if q %}&q={{ q }}&field={{ search_field }}{% endif %}" class="px-4 py-2 bg-zinc-900 hover:bg-zinc-800 border-2 border-amber-500/30 hover:border-amber-500/60 text-amber-400 rounded-xl transition-all">Primera</a>
    <a href="?page={{ empresas.previous_page_number }}{% if q %}&q={{ q }}&field={{ search_field }}{% endif %}" class="px-4 py-2 bg-zinc-900 hover:bg-zinc-800 border-2 border-amber-500/30 hover:border-amber-500/60 text-amber-400 rounded-xl transition-all">Anterior</a>
    {% endif %}
    
    <span class="px-6 py-2 bg-amber-500/10 border border-amber-500/30 rounded-xl text-amber-400 font-bold">
      P√°gina {{ empresas.number }} de {{ empresas.paginator.num_pages }}
    </span>
    
    {% if empresas.has_next %}
    <a href="?page={{ empresas.next_page_number }}{% if q %}&q={{ q }}&field={{ search_field }}{% endif %}" class="px-4 py-2 bg-zinc-900 hover:bg-zinc-800 border-2 border-amber-500/30 hover:border-amber-500/60 text-amber-400 rounded-xl transition-all">Siguiente</a>
    <a href="?page={{ empresas.paginator.num_pages }}{% if q %}&q={{ q }}&field={{ search_field }}{% endif %}" class="px-4 py-2 bg-zinc-900 hover:bg-zinc-800 border-2 border-amber-500/30 hover:border-amber-500/60 text-amber-400 rounded-xl transition-all">√öltima</a>
    {% endif %}
  </div>
  {% endif %}
</div>

{% endblock %}

{% block modals %}
{% if is_admin %}
<div class="modal fade" id="empresaModal" tabindex="-1" aria-labelledby="empresaModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content" style="background: linear-gradient(135deg, #18181b 0%, #0a0a0a 100%); color: #fff; border: 2px solid rgba(251, 191, 36, 0.4); border-radius: 1.5rem; box-shadow: 0 25px 50px rgba(251, 191, 36, 0.15);">
      <form method="POST" action="{% url 'home' %}" enctype="multipart/form-data" id="formAgregarEmpresa">
        {% csrf_token %}
        
        <!-- Header mejorado -->
        <div class="modal-header" style="border-bottom: 2px solid rgba(251, 191, 36, 0.2); padding: 1.5rem 2rem; background: rgba(251, 191, 36, 0.05);">
          <div class="d-flex align-items-center gap-3">
            <div style="background: linear-gradient(135deg, #fbbf24, #f59e0b); width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 16px rgba(251, 191, 36, 0.3);">
              <svg class="w-6 h-6" style="width: 28px; height: 28px; color: #000;" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
              </svg>
            </div>
            <div>
              <h5 class="modal-title mb-0" style="color: #fbbf24; font-weight: 800; font-size: 1.5rem; letter-spacing: -0.5px;">Agregar Nueva Empresa</h5>
              <p class="mb-0 mt-1" style="color: #a3a3a3; font-size: 0.875rem;">Complete los datos de la nueva empresa</p>
            </div>
          </div>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar" style="filter: brightness(0.8);"></button>
        </div>

        <!-- Body mejorado con grid -->
        <div class="modal-body" style="padding: 2rem;">
          <!-- Alerta informativa -->
          <div class="alert mb-4" style="background: rgba(251, 191, 36, 0.08); border: 1px solid rgba(251, 191, 36, 0.25); border-radius: 0.75rem; padding: 1rem;">
            <div class="d-flex align-items-center gap-2">
              <svg style="width: 20px; height: 20px; color: #fbbf24; flex-shrink: 0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <span style="color: #d4d4d8; font-size: 0.875rem;">Los campos marcados con <span style="color: #f87171;">*</span> son obligatorios</span>
            </div>
          </div>

          <!-- Grid 2 columnas -->
          <div class="row g-4">
            <!-- Cliente -->
            <div class="col-md-6">
              <label class="form-label d-flex align-items-center gap-2 mb-2" style="color: #fbbf24; font-weight: 700; font-size: 0.95rem;">
                <svg style="width: 18px; height: 18px;" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                </svg>
                Cliente <span style="color: #f87171;">*</span>
              </label>
              <input 
                type="text" 
                name="cliente" 
                class="form-control" 
                placeholder="Ej: Juan P√©rez"
                style="background: #0a0a0a; color: #fbbf24; border: 2px solid rgba(251, 191, 36, 0.25); border-radius: 0.75rem; padding: 0.75rem 1rem; font-size: 0.95rem; transition: all 0.3s;"
                onfocus="this.style.borderColor='rgba(251, 191, 36, 0.6)'; this.style.boxShadow='0 0 0 3px rgba(251, 191, 36, 0.1)'"
                onblur="this.style.borderColor='rgba(251, 191, 36, 0.25)'; this.style.boxShadow='none'"
                required
              />
            </div>

            <!-- Compa√±√≠a -->
            <div class="col-md-6">
              <label class="form-label d-flex align-items-center gap-2 mb-2" style="color: #fbbf24; font-weight: 700; font-size: 0.95rem;">
                <svg style="width: 18px; height: 18px;" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                </svg>
                Compa√±√≠a
              </label>
              <input 
                type="text" 
                name="compania" 
                class="form-control"
                placeholder="Ej: Tech Solutions S.A."
                style="background: #0a0a0a; color: #fbbf24; border: 2px solid rgba(251, 191, 36, 0.25); border-radius: 0.75rem; padding: 0.75rem 1rem; font-size: 0.95rem; transition: all 0.3s;"
                onfocus="this.style.borderColor='rgba(251, 191, 36, 0.6)'; this.style.boxShadow='0 0 0 3px rgba(251, 191, 36, 0.1)'"
                onblur="this.style.borderColor='rgba(251, 191, 36, 0.25)'; this.style.boxShadow='none'"
              />
            </div>

            <!-- Tel√©fono -->
            <div class="col-md-6">
              <label class="form-label d-flex align-items-center gap-2 mb-2" style="color: #fbbf24; font-weight: 700; font-size: 0.95rem;">
                <svg style="width: 18px; height: 18px;" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                </svg>
                Tel√©fono
              </label>
              <input 
                type="tel" 
                name="telefono" 
                class="form-control"
                placeholder="Ej: +1 234 567 8900"
                style="background: #0a0a0a; color: #fbbf24; border: 2px solid rgba(251, 191, 36, 0.25); border-radius: 0.75rem; padding: 0.75rem 1rem; font-size: 0.95rem; transition: all 0.3s;"
                onfocus="this.style.borderColor='rgba(251, 191, 36, 0.6)'; this.style.boxShadow='0 0 0 3px rgba(251, 191, 36, 0.1)'"
                onblur="this.style.borderColor='rgba(251, 191, 36, 0.25)'; this.style.boxShadow='none'"
              />
            </div>

            <!-- Correo -->
            <div class="col-md-6">
              <label class="form-label d-flex align-items-center gap-2 mb-2" style="color: #fbbf24; font-weight: 700; font-size: 0.95rem;">
                <svg style="width: 18px; height: 18px;" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
                Correo Electr√≥nico
              </label>
              <input 
                type="email" 
                name="correo" 
                class="form-control"
                placeholder="Ej: contacto@empresa.com"
                style="background: #0a0a0a; color: #fbbf24; border: 2px solid rgba(251, 191, 36, 0.25); border-radius: 0.75rem; padding: 0.75rem 1rem; font-size: 0.95rem; transition: all 0.3s;"
                onfocus="this.style.borderColor='rgba(251, 191, 36, 0.6)'; this.style.boxShadow='0 0 0 3px rgba(251, 191, 36, 0.1)'"
                onblur="this.style.borderColor='rgba(251, 191, 36, 0.25)'; this.style.boxShadow='none'"
              />
            </div>

            <!-- Pa√≠s -->
            <div class="col-12">
              <label class="form-label d-flex align-items-center gap-2 mb-2" style="color: #fbbf24; font-weight: 700; font-size: 0.95rem;">
                <svg style="width: 18px; height: 18px;" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Pa√≠s
              </label>
              <input 
                type="text" 
                name="pais" 
                class="form-control"
                placeholder="Ej: M√©xico"
                style="background: #0a0a0a; color: #fbbf24; border: 2px solid rgba(251, 191, 36, 0.25); border-radius: 0.75rem; padding: 0.75rem 1rem; font-size: 0.95rem; transition: all 0.3s;"
                onfocus="this.style.borderColor='rgba(251, 191, 36, 0.6)'; this.style.boxShadow='0 0 0 3px rgba(251, 191, 36, 0.1)'"
                onblur="this.style.borderColor='rgba(251, 191, 36, 0.25)'; this.style.boxShadow='none'"
              />
            </div>

            <!-- Logo con preview -->
            <div class="col-12">
              <label class="form-label d-flex align-items-center gap-2 mb-2" style="color: #fbbf24; font-weight: 700; font-size: 0.95rem;">
                <svg style="width: 18px; height: 18px;" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                Logo de la Empresa
              </label>
              <div style="background: #0a0a0a; border: 2px dashed rgba(251, 191, 36, 0.3); border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s;" 
                   onmouseover="this.style.borderColor='rgba(251, 191, 36, 0.6)'"
                   onmouseout="this.style.borderColor='rgba(251, 191, 36, 0.3)'">
                <input 
                  type="file" 
                  name="logo" 
                  id="logoInput"
                  class="form-control"
                  accept="image/*"
                  style="background: transparent; color: #fbbf24; border: none; padding: 0.5rem 0;"
                  onchange="previewLogo(event)"
                />
                <div id="logoPreview" class="mt-3 text-center" style="display: none;">
                  <img id="logoPreviewImg" src="" alt="Preview" style="max-width: 200px; max-height: 150px; border-radius: 0.5rem; border: 2px solid rgba(251, 191, 36, 0.3);"/>
                </div>
                <small style="color: #a3a3a3; display: block; margin-top: 0.5rem;">Formatos permitidos: JPG, PNG, GIF (m√°x. 5MB)</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer mejorado -->
        <div class="modal-footer" style="border-top: 2px solid rgba(251, 191, 36, 0.2); padding: 1.5rem 2rem; background: rgba(0, 0, 0, 0.2);">
          <button 
            type="button" 
            class="btn btn-secondary" 
            data-bs-dismiss="modal"
            style="padding: 0.75rem 1.5rem; border-radius: 0.75rem; font-weight: 600; transition: all 0.3s;"
          >
            ‚úï Cancelar
          </button>
          <button 
            type="submit" 
            class="btn fw-bold"
            style="background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #000; padding: 0.75rem 2rem; border-radius: 0.75rem; font-weight: 700; border: none; box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3); transition: all 0.3s;"
            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(251, 191, 36, 0.4)'"
            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(251, 191, 36, 0.3)'"
          >
            <svg style="width: 18px; height: 18px; display: inline-block; margin-right: 6px;" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
            </svg>
            Guardar Empresa
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
function previewLogo(event) {
  const file = event.target.files[0];
  const preview = document.getElementById('logoPreview');
  const previewImg = document.getElementById('logoPreviewImg');
  
  if (file && file.type.startsWith('image/')) {
    const reader = new FileReader();
    reader.onload = function(e) {
      previewImg.src = e.target.result;
      preview.style.display = 'block';
    };
    reader.readAsDataURL(file);
  } else {
    preview.style.display = 'none';
  }
}
</script>

{% for e in empresas %}
<div class="modal fade" id="editarEmpresaModal{{ e.id }}" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="background: #18181b; color: #fff; border: 2px solid rgba(251, 191, 36, 0.3); border-radius: 1.5rem;">
      <form method="POST" action="{% url 'editar_empresa' e.id %}" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-header" style="border-bottom: 1px solid rgba(251, 191, 36, 0.2);">
          <h5 class="modal-title" style="color: #ffd700">Editar Empresa</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label" style="color: #ffd700; font-weight: bold">Cliente</label>
            <input type="text" name="cliente" class="form-control" value="{{ e.cliente }}" style="background: #222; color: #ffd700; border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 0.75rem;" required/>
          </div>
          <div class="mb-3">
            <label class="form-label" style="color: #ffd700; font-weight: bold">Compa√±√≠a</label>
            <input type="text" name="compania" class="form-control" value="{{ e.compania }}" style="background: #222; color: #ffd700; border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 0.75rem;"/>
          </div>
          <div class="mb-3">
            <label class="form-label" style="color: #ffd700; font-weight: bold">Tel√©fono</label>
            <input type="text" name="telefono" class="form-control" value="{{ e.telefono }}" style="background: #222; color: #ffd700; border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 0.75rem;"/>
          </div>
          <div class="mb-3">
            <label class="form-label" style="color: #ffd700; font-weight: bold">Correo</label>
            <input type="email" name="correo" class="form-control" value="{{ e.correo }}" style="background: #222; color: #ffd700; border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 0.75rem;"/>
          </div>
          <div class="mb-3">
            <label class="form-label" style="color: #ffd700; font-weight: bold">Pa√≠s</label>
            <input type="text" name="pais" class="form-control" value="{{ e.pais }}" style="background: #222; color: #ffd700; border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 0.75rem;"/>
          </div>
          <div class="mb-3">
            <label class="form-label" style="color: #ffd700; font-weight: bold">Logo</label>
            <input type="file" name="logo" class="form-control" style="background: #222; color: #ffd700; border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 0.75rem;"/>
            {% if e.logo %}
            <small class="text-amber-400 mt-2 d-block">Logo actual: {{ e.logo.name }}</small>
            {% endif %}
          </div>
        </div>
        <div class="modal-footer" style="border-top: 1px solid rgba(251, 191, 36, 0.2);">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-warning text-black fw-bold">Actualizar</button>
        </div>
      </form>
    </div>
  </div>
</div>





<div class="modal fade" id="eliminarEmpresaModal{{ e.id }}" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div
      class="modal-content"
      style="background: #1a1a1d; color: #f5f5f5; border: 1px solid rgba(217, 119, 6, 0.4); border-radius: 1.5rem; box-shadow: 0 0 25px rgba(217, 119, 6, 0.15);"
    >
      <form method="POST" action="{% url 'eliminar_empresa' e.id %}" onsubmit="return validarEliminacion{{ e.id }}()">
        {% csrf_token %}
        <div class="modal-header" style="border-bottom: 1px solid rgba(217, 119, 6, 0.3);">
          <h5 class="modal-title" style="color: #eab308; font-weight: 700; letter-spacing: 0.5px;">
            ‚ö†Ô∏è Eliminar Empresa
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>

        <div class="modal-body">
          <div
            class="alert"
            style="background: rgba(234, 179, 8, 0.08); border: 1px solid rgba(234, 179, 8, 0.25); border-radius: 0.75rem; padding: 1.25rem;"
          >
            <p class="mb-3" style="font-weight: 600; color: #f1f1f1;">‚ö†Ô∏è Esta acci√≥n no se puede deshacer.</p>
            <p class="mb-3" style="color: #d4d4d8;">Est√°s a punto de eliminar la empresa:</p>
            <p
              class="mb-2"
              style="color: #facc15; font-size: 1.15rem; font-weight: 700; text-transform: capitalize;"
            >
              {{ e.compania }}
            </p>
            <p class="mb-0" style="color: #c1c1c1;">C√≥digo: <strong style="color: #facc15;">{{ e.codigo }}</strong></p>
          </div>

          <div class="mb-3 mt-4">
            <label class="form-label" style="color: #eab308; font-weight: 600;">
              Para confirmar, escribe
              <span
                style="background: rgba(234, 179, 8, 0.15); padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-family: monospace; color: #fde68a;"
                >eliminar</span
              >
              en el campo de abajo:
            </label>
            <input
              type="text"
              name="confirmacion"
              id="confirmacion{{ e.id }}"
              class="form-control"
              placeholder="Escribe: eliminar"
              style="background: #2a2a2e; color: #fff; border: 1.8px solid rgba(234, 179, 8, 0.4); border-radius: 0.75rem; transition: border 0.3s;"
              onfocus="this.style.border='1.8px solid rgba(234,179,8,0.7)'"
              onblur="this.style.border='1.8px solid rgba(234,179,8,0.4)'"
              autocomplete="off"
              required
            />
          </div>
        </div>

        <div class="modal-footer" style="border-top: 1px solid rgba(234, 179, 8, 0.25);">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button
            type="submit"
            class="btn fw-bold"
            style="
              background: linear-gradient(135deg, #eab308, #d97706);
              color: #000;
              border: none;
              font-weight: 700;
              letter-spacing: 0.3px;
              transition: all 0.3s;
            "
            onmouseover="this.style.background='linear-gradient(135deg, #facc15, #b45309)'"
            onmouseout="this.style.background='linear-gradient(135deg, #eab308, #d97706)'"
          >
            Eliminar definitivamente
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  function validarEliminacion{{ e.id }}() {
    const input = document.getElementById('confirmacion{{ e.id }}');
    if (input.value.trim().toLowerCase() !== 'eliminar') {
      alert('‚ö†Ô∏è Debes escribir exactamente "eliminar" para confirmar.');
      input.focus();
      return false;
    }
    return true;
  }
</script>


<script>
function validarEliminacion{{ e.id }}() {
  const input = document.getElementById('confirmacion{{ e.id }}').value.trim().toLowerCase();
  if (input !== 'eliminar') {
    alert('‚ö†Ô∏è Debes escribir exactamente "eliminar" para confirmar.');
    return false;
  }
  return true;
}
</script>
{% endfor %}
{% endif %}
{% endblock %}
